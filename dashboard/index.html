<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>FM Dashboard</title>
  <style>
    body { font-family: sans-serif; background: #0b0b0b; color: white; text-align: center; }
    input, select, button { margin: 8px; padding: 10px; border-radius: 6px; border: none; }
    .poster { width: 150px; height: 150px; border-radius: 12px; object-fit: cover; }
  </style>
</head>
<body>
  <h2>ðŸŽ§ FM Control Dashboard</h2>
  <input id="title" placeholder="Song Title"><br>
  <input id="poster" placeholder="Poster URL"><br>
  <input id="audio" placeholder="Audio URL"><br>
  <select id="quality">
    <option value="low">Low (64kbps)</option>
    <option value="medium" selected>Medium (128kbps)</option>
    <option value="high">High (320kbps)</option>
  </select><br>
  <button onclick="startSong()">Play</button>
  <button onclick="pauseSong()">Pause</button>
  <h4>Status: <span id="status">Idle</span></h4>
  <img id="preview" class="poster">

  <script>
    const WS_URL = (location.protocol === "https:" ? "wss://" : "ws://") + location.host;
    const ws = new WebSocket(WS_URL);

    ws.onopen = () => {
      ws.send(JSON.stringify({ type: "register", role: "broadcaster" }));
      document.getElementById("status").innerText = "Connected";
    };

    function broadcast(data) {
      ws.send(JSON.stringify({ type: "broadcast", ...data }));
    }

    function startSong() {
      const title = document.getElementById("title").value;
      const poster = document.getElementById("poster").value;
      const audio = document.getElementById("audio").value;
      const quality = document.getElementById("quality").value;
      document.getElementById("preview").src = poster;
      broadcast({ subtype: "play", title, poster, audio, quality });
    }

    function pauseSong() {
      broadcast({ subtype: "pause" });
    }
  </script>
</body>
</html>
